<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth Cookie</title>
</head>
<body>
    <h1>Hello World!</h1>
    <hr></hr>
    <span>Cookie login</span>
    <hr></hr>
    ID : <input id="id" type="text" placeholder="test"></input>
    PW : <input id="pw" type="text" placeholder="test"></input>
    <input id="btn" type="button" value="Login"></input>
    <hr></hr>
    <hr></hr>
    <h3>logs</h3>
    <textarea id="logs"  rows="15" cols="80"></textarea>

</body>
<script>
    const xhr = new XMLHttpRequest(); 
    const method = "POST"; 
    const url = "/cookie/login"; // 요청을 초기화 합니다. 

    const getCookie = function (name) { 
        var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)'); 
        return value ? decodeURIComponent(value[2]) : null; 
    };

    function appendLog(aLogMsg) {
        document.getElementById("logs").textContent = document.getElementById("logs").textContent + "---------------------------------\n" + aLogMsg + "\n";
    }
    
    function login() {
        var param = {
            "id" : document.getElementById("id").value,
            "pw" : document.getElementById("pw").value
        };
        let res;
        appendLog("입력값 \nid:" + param["id"] + "\npw: " + param["pw"]);
        xhr.open(method, url); // onreadystatechange 이벤트를 이용해 요청에 대한 응답 결과를 처리합니다. 
        xhr.setRequestHeader('Content-type', 'application/json')
        xhr.onreadystatechange = function (event) { 
            const {   target } = event;
            if (target.readyState === XMLHttpRequest.DONE) { 
                const { status } = target;
                res = xhr.response;
                appendLog("응답결과 : " + xhr.response);
                if (status === 0 || (status >= 200 && status < 400)) { // 요청이 정상적으로 처리 된 경우 

                } else { // 에러가 발생한 경우

                } 
            } 
        }; // 서버에 요청을 보냅니다. 

        xhr.send(JSON.stringify(param));
    }

    
    document.getElementById("btn").onclick = login;
</script>
</html>